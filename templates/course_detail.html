{% extends "base.html" %}
{% block title %}{{ course.title }}{% endblock %}

{% block content %}
<div class="container">
    <h2>{{ course.title }}</h2>

    {% if is_enrolled %}
    <p>Kurs progressi: {{ progress }}%</p>

    <!-- Modullar va darslar roâ€˜yxati -->
    {% for m in modules %}
    <div class="mb-4">
        <h4>{{ m.title }}</h4>
        <ul class="list-group">
            {% for l in m.lessons.all %}
            <li class="list-group-item">
                <a href="{% url 'lesson_detail' course.id l.id %}">
                    {{ l.title }}
                </a>
            </li>
            {% empty %}
            <li class="list-group-item">Darslar yoâ€˜q</li>
            {% endfor %}
        </ul>
    </div>
    {% endfor %}

    {% else %}
    <p>Siz bu kursga yozilmagansiz.</p>

    {% if user.is_authenticated %}
    <!-- Agar login boâ€˜lsa toâ€˜gâ€˜ridan-toâ€˜gâ€˜ri yoziladi -->
    <a href="{% url 'enroll_course' course.id %}" class="btn btn-success">
        ðŸ“š Kursga yozilish
    </a>
    {% else %}
    <!-- Login qilmagan boâ€˜lsa avval login sahifaga yoâ€˜naltiramiz -->
    <a href="{% url 'login' %}?next={% url 'enroll_course' course.id %}" class="btn btn-warning">
        ðŸ”‘ Avval login qiling
    </a>
    {% endif %}
    {% endif %}
</div>
{% endblock %}